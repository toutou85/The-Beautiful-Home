<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
  <style>
    body { font-family: Tahoma, sans-serif; margin: 0; background: #f9f9f9; padding: 20px; }
    h1 { color: #005f73; text-align: center; margin-bottom: 10px; }
    .swiper { width: 100%; height: 300px; margin-bottom: 20px; }
    .swiper-slide img { width: 100%; height: 100%; object-fit: cover; border-radius: 10px; }
    .description { background: #fff; padding: 15px; border-radius: 10px; line-height: 1.7; box-shadow: 0 2px 8px rgba(0,0,0,0.1); white-space: pre-line; }
    .not-found { background: #fff; padding: 15px; border-radius: 10px; color: #d32f2f; font-size: 1.2rem; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .actions { margin-top: 15px; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
    .actions button { padding: 8px 14px; font-size: 0.95rem; border: none; border-radius: 6px; cursor: pointer; }
    .share { background: #0a9396; color: white; }
    .like-btn { background: #ee9b00; color: white; }
    .rating { text-align: center; margin-top: 10px; }
    .stars span { font-size: 24px; cursor: pointer; color: gray; }
    .stars span.selected { color: gold; }
    .comments { margin-top: 25px; background: #fff; padding: 15px; border-radius: 10px; }
    .comments h3 { margin-top: 0; color: #005f73; }
    .comments textarea { width: 100%; padding: 8px; border-radius: 8px; border: 1px solid #ccc; resize: vertical; }
    .comments button { margin-top: 10px; background: #0077b6; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; }
    .comment-list { margin-top: 15px; }
    .comment-list p { background: #f1f1f1; padding: 8px 10px; border-radius: 6px; margin-bottom: 8px; }
  </style>
</head>
<body>

<h1 id="productName">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬</h1>

<!-- âœ… Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± -->
<div class="swiper" id="slider" style="display: none;">
  <div class="swiper-wrapper" id="imageSlides"></div>
  <div class="swiper-button-next"></div>
  <div class="swiper-button-prev"></div>
  <div class="swiper-pagination"></div>
</div>

<!-- âœ… ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬ -->
<div class="description" id="productDesc">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>

<!-- âœ… Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ -->
<div class="actions">
  <button class="share" onclick="shareProduct()">ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬</button>
  <button class="like-btn" onclick="likeProduct()">ğŸ‘ Ø£Ø¹Ø¬Ø¨Ù†ÙŠ <span id="likeCount">0</span></button>
</div>

<!-- âœ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ø§Ù„Ù†Ø¬ÙˆÙ… -->
<div class="rating">
  â­ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:
  <div class="stars" id="stars">
    <span onclick="rate(1)">â˜…</span>
    <span onclick="rate(2)">â˜…</span>
    <span onclick="rate(3)">â˜…</span>
    <span onclick="rate(4)">â˜…</span>
    <span onclick="rate(5)">â˜…</span>
  </div>
</div>

<!-- âœ… Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª -->
<div class="comments">
  <h3>ğŸ’¬ Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø²Ø¨Ø§Ø¦Ù†</h3>
  <textarea id="commentInput" rows="3" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§..."></textarea>
  <button onclick="addComment()">Ù†Ø´Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ‚</button>
  <div class="comment-list" id="commentList"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
<script>
const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRGmRO6TOlY4g8QiNx6jZJPESabHQeKvtGLHgm614oIPdfLXhSeE7YZSdHSvKhLkIvcKSgFcmuJz6gr/pub?gid=1873815062&single=true&output=csv";
const urlParams = new URLSearchParams(window.location.search);
const productName = decodeURIComponent(urlParams.get("name") || "").trim();
document.getElementById("productName").textContent = productName || "Ø§Ø³Ù… ØºÙŠØ± Ù…Ø­Ø¯Ø¯";

if (!productName) {
  document.getElementById("productDesc").innerHTML = `<div class="not-found">âš ï¸ Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬.</div>`;
} else {
  fetch(sheetURL)
    .then(res => res.text())
    .then(csv => {
      const rows = csv.trim().split("\n").slice(1);
      const data = rows.map(row => {
        const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
        const name = cols[0]?.trim() || "";
        const images = cols[1]?.trim() || "";
        const desc = cols[2]?.trim() || "";
        return {
          name: name.toLowerCase(),
          images: images.split(",").map(img => img.trim()),
          desc
        };
      }).filter(item => item.name !== "");

      const found = data.find(item => item.name === productName.toLowerCase());

      if (found) {
        const slides = found.images.map(img => `<div class="swiper-slide"><img src="${img}" alt=""></div>`).join("");
        document.getElementById("imageSlides").innerHTML = slides;
        document.getElementById("slider").style.display = "block";
        document.getElementById("productDesc").innerHTML = found.desc;

        new Swiper(".swiper", {
          loop: true,
          pagination: { el: ".swiper-pagination" },
          navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" }
        });
      } else {
        document.getElementById("productDesc").innerHTML = `<div class="not-found">âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬.</div>`;
      }
    })
    .catch(err => {
      console.error(err);
      document.getElementById("productDesc").innerHTML = `<div class="not-found">âš ï¸ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</div>`;
    });
}

// âœ… Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬
function shareProduct() {
  const name = document.getElementById("productName").textContent;
  const desc = document.getElementById("productDesc").textContent;
  const shareData = {
    title: `Ù…Ù†ØªØ¬: ${name}`,
    text: `${name}\n\n${desc}`,
    url: window.location.href
  };
  navigator.share ? navigator.share(shareData) : alert("Ø¬Ù‡Ø§Ø²Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©.");
}

// âœ… Ø£Ø¹Ø¬Ø¨Ù†ÙŠ
let likeCount = 0;
function likeProduct() {
  likeCount++;
  document.getElementById("likeCount").textContent = likeCount;
}

// âœ… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†Ø¬ÙˆÙ…
function rate(star) {
  const stars = document.querySelectorAll("#stars span");
  stars.forEach((s, i) => {
    s.classList.toggle("selected", i < star);
  });
}

// âœ… Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª
function addComment() {
  const comment = document.getElementById("commentInput").value.trim();
  if (comment) {
    const p = document.createElement("p");
    p.textContent = comment;
    document.getElementById("commentList").appendChild(p);
    document.getElementById("commentInput").value = "";
  }
}
</script>
</body>
</html>